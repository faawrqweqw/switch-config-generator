# ğŸš€ éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•åœ¨ä¸åŒç¯å¢ƒä¸­éƒ¨ç½²äº¤æ¢æœºé…ç½®å‘½ä»¤ç”Ÿæˆå¹³å°ã€‚

## ğŸ“‹ éƒ¨ç½²é€‰é¡¹

### 1. æœ¬åœ°å¼€å‘ç¯å¢ƒ
é€‚åˆå¼€å‘å’Œæµ‹è¯•ä½¿ç”¨ã€‚

### 2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
é€‚åˆæ­£å¼ä½¿ç”¨ï¼Œæ”¯æŒå¤šç”¨æˆ·å¹¶å‘è®¿é—®ã€‚

### 3. Dockerå®¹å™¨éƒ¨ç½²
é€‚åˆå¿«é€Ÿéƒ¨ç½²å’Œå®¹å™¨åŒ–ç¯å¢ƒã€‚

### 4. äº‘å¹³å°éƒ¨ç½²
é€‚åˆéœ€è¦å…¬ç½‘è®¿é—®çš„åœºæ™¯ã€‚

## ğŸ”§ æœ¬åœ°å¼€å‘ç¯å¢ƒ

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- pipåŒ…ç®¡ç†å™¨
- ç°ä»£Webæµè§ˆå™¨

### éƒ¨ç½²æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-username/switch-config-generator.git
cd switch-config-generator
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/macOS
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **è¿è¡Œåº”ç”¨**
```bash
python run.py
```

5. **è®¿é—®åº”ç”¨**
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5000

## ğŸ­ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### ä½¿ç”¨Gunicorn + Nginx

#### 1. å®‰è£…Gunicorn
```bash
pip install gunicorn
```

#### 2. åˆ›å»ºGunicorné…ç½®æ–‡ä»¶
åˆ›å»º `gunicorn.conf.py`ï¼š

```python
# gunicorn.conf.py
bind = "127.0.0.1:8000"
workers = 4
worker_class = "sync"
worker_connections = 1000
timeout = 30
keepalive = 2
max_requests = 1000
max_requests_jitter = 100
preload_app = True
```

#### 3. åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
åˆ›å»º `/etc/systemd/system/switch-config.service`ï¼š

```ini
[Unit]
Description=Switch Config Generator
After=network.target

[Service]
User=www-data
Group=www-data
WorkingDirectory=/path/to/switch-config-generator
Environment="PATH=/path/to/switch-config-generator/venv/bin"
ExecStart=/path/to/switch-config-generator/venv/bin/gunicorn -c gunicorn.conf.py run:app
Restart=always

[Install]
WantedBy=multi-user.target
```

#### 4. å¯åŠ¨æœåŠ¡
```bash
sudo systemctl daemon-reload
sudo systemctl enable switch-config
sudo systemctl start switch-config
```

#### 5. é…ç½®Nginx
åˆ›å»º `/etc/nginx/sites-available/switch-config`ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static {
        alias /path/to/switch-config-generator/static;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

å¯ç”¨ç«™ç‚¹ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/switch-config /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

## ğŸ³ Dockeréƒ¨ç½²

### 1. åˆ›å»ºDockerfile
```dockerfile
FROM python:3.9-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .

# å®‰è£…Pythonä¾èµ–
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash app \
    && chown -R app:app /app
USER app

# æš´éœ²ç«¯å£
EXPOSE 5000

# å¯åŠ¨å‘½ä»¤
CMD ["gunicorn", "--bind", "0.0.0.0:5000", "--workers", "4", "run:app"]
```

### 2. åˆ›å»ºdocker-compose.yml
```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      - FLASK_ENV=production
    volumes:
      - ./config_templates:/app/config_templates:ro
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./static:/app/static:ro
    depends_on:
      - web
    restart: unless-stopped
```

### 3. æ„å»ºå’Œè¿è¡Œ
```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## â˜ï¸ äº‘å¹³å°éƒ¨ç½²

### Herokuéƒ¨ç½²

#### 1. å®‰è£…Heroku CLI
è®¿é—® [Heroku CLI](https://devcenter.heroku.com/articles/heroku-cli) ä¸‹è½½å®‰è£…ã€‚

#### 2. åˆ›å»ºProcfile
```
web: gunicorn run:app
```

#### 3. åˆ›å»ºruntime.txt
```
python-3.9.18
```

#### 4. éƒ¨ç½²åˆ°Heroku
```bash
# ç™»å½•Heroku
heroku login

# åˆ›å»ºåº”ç”¨
heroku create your-app-name

# æ¨é€ä»£ç 
git push heroku main

# æ‰“å¼€åº”ç”¨
heroku open
```

### AWS EC2éƒ¨ç½²

#### 1. å¯åŠ¨EC2å®ä¾‹
- é€‰æ‹©Ubuntu 20.04 LTS
- é…ç½®å®‰å…¨ç»„ï¼ˆå¼€æ”¾80å’Œ22ç«¯å£ï¼‰
- åˆ›å»ºæˆ–é€‰æ‹©å¯†é’¥å¯¹

#### 2. è¿æ¥åˆ°å®ä¾‹
```bash
ssh -i your-key.pem ubuntu@your-ec2-ip
```

#### 3. å®‰è£…ä¾èµ–
```bash
sudo apt update
sudo apt install python3 python3-pip python3-venv nginx git
```

#### 4. éƒ¨ç½²åº”ç”¨
æŒ‰ç…§ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ­¥éª¤è¿›è¡Œã€‚

### é˜¿é‡Œäº‘ECSéƒ¨ç½²

ç±»ä¼¼AWS EC2ï¼Œé€‰æ‹©åˆé€‚çš„é•œåƒå’Œé…ç½®ï¼Œç„¶åæŒ‰ç…§ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ­¥éª¤è¿›è¡Œã€‚

## ğŸ”’ å®‰å…¨é…ç½®

### 1. ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
FLASK_ENV=production
SECRET_KEY=your-secret-key-here
```

### 2. é˜²ç«å¢™é…ç½®
```bash
# Ubuntu/Debian
sudo ufw allow 22
sudo ufw allow 80
sudo ufw allow 443
sudo ufw enable
```

### 3. SSLè¯ä¹¦é…ç½®
ä½¿ç”¨Let's Encryptå…è´¹è¯ä¹¦ï¼š

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### 1. åº”ç”¨æ—¥å¿—
é…ç½®æ—¥å¿—è®°å½•ï¼š

```python
# config.py
import logging
from logging.handlers import RotatingFileHandler

if not app.debug:
    file_handler = RotatingFileHandler('logs/app.log', maxBytes=10240, backupCount=10)
    file_handler.setFormatter(logging.Formatter(
        '%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d]'
    ))
    file_handler.setLevel(logging.INFO)
    app.logger.addHandler(file_handler)
    app.logger.setLevel(logging.INFO)
```

### 2. ç³»ç»Ÿç›‘æ§
ä½¿ç”¨htopç›‘æ§ç³»ç»Ÿèµ„æºï¼š

```bash
sudo apt install htop
htop
```

### 3. åº”ç”¨ç›‘æ§
æŸ¥çœ‹åº”ç”¨çŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status switch-config

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u switch-config -f
```

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### 1. åº”ç”¨æ›´æ–°
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡å¯æœåŠ¡
sudo systemctl restart switch-config
```

### 2. ä¾èµ–æ›´æ–°
```bash
# æ›´æ–°ä¾èµ–
pip install -r requirements.txt --upgrade

# é‡å¯æœåŠ¡
sudo systemctl restart switch-config
```

### 3. å¤‡ä»½
```bash
# å¤‡ä»½é…ç½®æ–‡ä»¶
tar -czf backup-$(date +%Y%m%d).tar.gz config_templates/ templates/

# å®šæœŸå¤‡ä»½è„šæœ¬
echo "0 2 * * * /path/to/backup-script.sh" | crontab -
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
```bash
sudo lsof -i :5000
sudo kill -9 PID
```

2. **æƒé™é—®é¢˜**
```bash
sudo chown -R www-data:www-data /path/to/app
sudo chmod -R 755 /path/to/app
```

3. **å†…å­˜ä¸è¶³**
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# æ·»åŠ swapç©ºé—´
sudo fallocate -l 1G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

## ğŸ“ è·å–æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
2. æ£€æŸ¥ç³»ç»Ÿèµ„æº
3. éªŒè¯ç½‘ç»œè¿æ¥
4. æäº¤Issueåˆ°GitHubä»“åº“

---

ğŸ‰ éƒ¨ç½²å®Œæˆï¼æ‚¨çš„äº¤æ¢æœºé…ç½®ç”Ÿæˆå¹³å°ç°åœ¨å¯ä»¥ä¸ºç”¨æˆ·æä¾›æœåŠ¡äº†ï¼
